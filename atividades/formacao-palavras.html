<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8" />
    <title>Forma√ß√£o de Palavras - EducaPlay</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f4fdf6;
            margin: 0;
        }

        header {
            background: #4CAF50;
            color: white;
            padding: 20px;
            text-align: center;
        }

        main {
            max-width: 800px;
            margin: 30px auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, .1);
        }

        #stars {
            text-align: center;
            font-size: 1.5em;
            margin-bottom: 12px;
            color: #2a7a2a;
        }

        p {
            text-align: center;
            margin: 6px 0 18px;
        }

        .container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 14px;
        }

        .letter {
            background: #d4edda;
            padding: 12px 16px;
            border-radius: 6px;
            font-size: 1.2em;
            cursor: grab;
            user-select: none;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.08);
        }

        #word-zone {
            min-height: 60px;
            border: 2px dashed #4CAF50;
            padding: 10px;
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 12px;
        }

        .btn {
            background: #4CAF50;
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1.1em;
            margin: 6px;
        }

        .btn:hover {
            background: #45a049;
        }

        #final-message {
            text-align: center;
            margin-top: 12px;
            font-size: 1.15em;
        }

        .botao-amarelo {
            background: #FFD700;
            padding: 12px 30px;
            border: none;
            font-weight: bold;
            border-radius: 6px;
            margin-top: 14px;
            display: inline-block;
            cursor: pointer;
            font-size: 1.1em;
            margin: 6px;
        }

         .botao-azul {
            background: #005aa3;
            padding: 12px 30px;
            border: none;
            font-weight: bold;
            border-radius: 6px;
            margin-top: 14px;
            display: inline-block;
            cursor: pointer;
            font-size: 1.1em;
            margin: 6px;
        }

        .hint {
            font-size: 0.95em;
            color: #666;
            text-align: center;
            margin-bottom: 8px;
            user-select: none;
        }

        @media (max-width:600px) {
            .letter {
                padding: 10px 12px;
                font-size: 1.05em;
            }

            .btn {
                padding: 10px 20px;
                font-size: 1em;
            }
        }
    </style>
</head>

<body>
    <header>
        <h1>Forma√ß√£o de Palavras</h1>
    </header>
    <main>
        <div id="stars">‚≠ê 0</div>
        <p>Arraste as letras para formar a palavra correta:</p>

        <div class="container" id="letters"></div>
        <div id="word-zone" aria-label="Espa√ßo para formar palavra"></div>

        <div style="text-align:center;">
            <button class="btn" onclick="checkWord()">Verificar</button>
            <button class="botao-azul" id="nextBtn" style="display:none;" onclick="nextWord()">Pr√≥xima</button>
            <button class="botao-amarelo" onclick="clearZone()">Limpar</button>
        </div>

        <div id="final-message"></div>
        <div style="text-align:center;">
            <button type="button" onclick="window.location.href='../index.html'" class="botao-amarelo" id="backBtn"
                style="display:none;">Voltar ao Menu</button>
        </div>
    </main>

    <script>
        const starsEl = document.getElementById("stars");
        const lettersEl = document.getElementById("letters");
        const wordZone = document.getElementById("word-zone");
        const finalMessage = document.getElementById("final-message");
        const nextBtn = document.getElementById("nextBtn");
        const backBtn = document.getElementById("backBtn");

        let score = 0;
        let currentIndex = 0;

        const words = ["GATO"]; // lista de palavras

        // Gera um id √∫nico simples
        function uid(prefix = "") {
            return prefix + Math.random().toString(36).slice(2, 9);
        }

        function loadWord() {
            // reset visual e controles
            lettersEl.innerHTML = "";
            wordZone.innerHTML = "";
            finalMessage.textContent = "";
            nextBtn.style.display = "none";
            backBtn.style.display = "none";

            const word = words[currentIndex];
            // cria array de objetos {ch, id} para cada letra (permite letras repetidas)
            const lettersArr = word.split("").map((ch, i) => ({ ch, id: `${ch}-${i}-${uid()}` }));
            // embaralha
            lettersArr.sort(() => Math.random() - 0.5);

            // criar letras na √°rea de origem
            lettersArr.forEach(item => {
                const div = document.createElement("div");
                div.textContent = item.ch;
                div.className = "letter";
                div.id = item.id;
                div.draggable = true;

                // arrastar: colocamos o id para que o drop mova o elemento real
                div.addEventListener("dragstart", (e) => {
                    e.dataTransfer.setData("text/plain", item.id);
                    // opcional: menor opacidade enquanto arrasta
                    setTimeout(() => div.style.opacity = "0.5", 0);
                });
                div.addEventListener("dragend", () => {
                    div.style.opacity = "1";
                });

                lettersEl.appendChild(div);
            });

            // permitir dropar (mover) no espa√ßo da palavra
            wordZone.addEventListener("dragover", (e) => e.preventDefault());
            wordZone.addEventListener("drop", onDropToZone);

            // clicar numa letra no zone devolve para lettersEl
            wordZone.addEventListener("click", (e) => {
                if (e.target && e.target.classList.contains("letter")) {
                    lettersEl.appendChild(e.target);
                }
            });
        }

        function onDropToZone(e) {
            e.preventDefault();
            const id = e.dataTransfer.getData("text/plain");
            if (!id) return;
            const dragged = document.getElementById(id);
            if (!dragged) return;
            // se j√° estiver na zone, n√£o faz nada (permite rearranjo via clique)
            if (dragged.parentElement === wordZone) return;
            // move o elemento real para o zone (sem criar c√≥pia)
            wordZone.appendChild(dragged);
        }

        function checkWord() {
            const formed = Array.from(wordZone.children).map(l => l.textContent).join("");
            const word = words[currentIndex];

            if (!formed) {
                finalMessage.textContent = "Voc√™ precisa colocar as letras no espa√ßo primeiro.";
                return;
            }

            if (formed === word) {
                score++;
                starsEl.textContent = `‚≠ê ${score}`;
                finalMessage.textContent = "Parab√©ns! Palavra correta üéâ";
                nextBtn.style.display = "inline-block";
                // opcional: bloquear devolu√ß√£o ap√≥s acerto (deixa como est√°)
            } else {
                finalMessage.textContent = "Ops! Est√° incorreta. Limpe para tentar novamente.";
                // o usu√°rio pode clicar nas letras do espa√ßo para devolver/remodelar
            }
        }

        function nextWord() {
            currentIndex++;
            if (currentIndex < words.length) {
                loadWord();
            } else {
                showFinalMessage();
            }
        }

        function clearZone() {
            const elems = Array.from(wordZone.children);
            elems.forEach(el => lettersEl.appendChild(el));
            finalMessage.textContent = "";
            nextBtn.style.display = "none";
        }

        function showFinalMessage() {
            wordZone.style.display = "none";
            nextBtn.style.display = "none";
            finalMessage.innerHTML = `‚ú® Voc√™ concluiu todas as palavras!<br>Acertos: <strong>${score}</strong> de <strong>${words.length}</strong> ‚≠ê`;
            backBtn.style.display = "inline-block";
        }

        // iniciar
        loadWord();
    </script>
</body>

</html>